<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Codeland • Edit Question</title>
  <link rel="stylesheet" href="styleDeema.css">
    <link rel="stylesheet" href="HF.css">

</head>
<body>

 <!-- ====== HEADER ====== -->
<header class="cl-header">
  <div class="brand">
    <img src="images/logo.png" alt="Logo">
    <span>Codeland</span>
  </div>

  <div class="actions">
    <a href="educator.html">
        <img src="images/educatorUser.jpeg" alt="User" class="avatar">
    </a>
    <a href="index.html" class="logout-btn">Logout</a>
   
  </div>
</header>

  <div class="container">
    <div class="page-header header-user"></div>
    <div id="toast" class="toast"></div>

    <section class="card page-header">
      <h1>Edit Question</h1>
      <a id="cancel-link" class="btn-outline">Cancel</a>
    </section>

    <section class="card">
      <form id="question-form">
        <label>Question Text</label><textarea name="text" rows="3" class="input" required></textarea>
        <label>Choice A</label><input name="c0" class="input" required>
        <label>Choice B</label><input name="c1" class="input" required>
        <label>Choice C</label><input name="c2" class="input" required>
        <label>Choice D</label><input name="c3" class="input" required>

        <label>Correct Choice</label>
        <select name="correctIndex" class="input" required>
          <option value="0">A</option><option value="1">B</option><option value="2">C</option><option value="3">D</option>
        </select>

        <label>Figure (optional)</label><input type="file" name="figure" accept="image/*" class="input">

        <hr class="sep">
        <div class="flex"><button type="submit" class="btn">Save</button><span class="helper"></span></div>
      </form>
    </section>
  </div>
<!-- ====== FOOTER ====== -->
<footer class="cl-footer">
 <p>OUR VISION</p>
 <p>At CodeLand, we make coding education simple, engaging, and accessible for everyone</p>
  <p>© <span id="year"></span>2025 Website. All rights reserved.</p>
  <div class="social">
    <a href="#"><img src="images/xpng.jpg" alt="Twitter"></a>
    <a href="#"><img src="images/facebook.png" alt="Facebook"></a>
    <a href="#"><img src="images/instagram.png" alt="Instagram"></a>
  </div>
</footer>
 
<script src="js-deema/data.nomodule.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
  const form = document.getElementById('question-form');
  const cancelLink = document.getElementById('cancel-link');

  const backUrl =
    localStorage.getItem('currentQuestionReturnUrl') ||
    (document.referrer && /quiz\.html/i.test(document.referrer) ? document.referrer : 'Quiz.html');

  cancelLink.href = backUrl;

  // حمّل السؤال المؤقت
  const raw = localStorage.getItem('currentQuestion');
  if (!raw) {
    alert('لم يتم العثور على سؤال للتعديل. افتحي صفحة الكويز واضغطي Edit.');
    location.href = backUrl;
    return;
  }
  const q = JSON.parse(raw);

  // عبّئي الحقول
  form.elements['text'].value = q.text || '';
  form.elements['c0'].value = q.choices?.[0] ?? '';
  form.elements['c1'].value = q.choices?.[1] ?? '';
  form.elements['c2'].value = q.choices?.[2] ?? '';
  form.elements['c3'].value = q.choices?.[3] ?? '';
  form.elements['correctIndex'].value = String(q.correctIndex ?? 0);

  // حفظ التعديل
  form.addEventListener('submit', function (e) {
    e.preventDefault();

    const updated = {
      // احتفظ بالنص الأصلي لتحديد الصف عند الرجوع
      originalText: q.originalText || q.text || '',
      text: form.elements['text'].value.trim(),
      choices: [
        form.elements['c0'].value,
        form.elements['c1'].value,
        form.elements['c2'].value,
        form.elements['c3'].value
      ],
      correctIndex: Number(form.elements['correctIndex'].value)
    };

    localStorage.setItem('currentQuestion', JSON.stringify(updated));
    localStorage.setItem('currentQuestionUpdated', '1'); // علَم للتطبيق في صفحة الكويز
    location.href = backUrl;
  });

  // Cancel يرجّع بدون تغيير
  cancelLink.addEventListener('click', function (e) {
    e.preventDefault();
    location.href = backUrl;
  });
});
</script>


</body>
</html>
