<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Codeland • Educator</title>
 
  <link rel="stylesheet" href="styleDeema.css">
  <link rel="stylesheet" href="HF.css">
</head>
<body>
<!-- ====== HEADER ====== -->
<header class="cl-header">
  <div class="brand">
    <img src="images/logo.png" alt="Logo">
    <span>Codeland</span>
  </div>

  <div class="actions">
      <a href="educator.html">
        <img src="images/educatorUser.jpeg" alt="User" class="avatar">
    </a>
    <a href="index.html" class="logout-btn">Logout</a>
  </div>
</header>



  <!-- ====== MAIN CONTENT ====== -->
  <div class="container">
  
<div class="header header-user"></div>

    <div id="toast" class="toast"></div>

    <!-- Welcome section -->
    <section id="welcome"></section>

    <!-- Educator info -->
    <section class="card" id="educator-info"></section>

    <!-- Quizzes table -->
    <section class="card">
      <h2>Your Quizzes</h2>
      <table class="table" id="quizzes-table">
        <thead>
          <tr>
            <th>Topic</th>
            <th>#Questions</th>
            <th>Stats</th>
            <th>Feedback</th>
          </tr>
        </thead>
        <tbody>
         
        </tbody>
      </table>
    </section>

    <!-- Recommended questions -->
    <section class="card">
      <h2>Recommended Questions</h2>
      <table class="table" id="recommended-table">
        <thead>
          <tr>
            <th>Topic</th>
            <th>Learner</th>
            <th>Question</th>
            <th>Review</th>
          </tr>
        </thead>
        <tbody>
     <tr data-id="rec-1001">
  <td class="td-topic">HTML 101</td>
  <td class="td-learner">
    <img src="images/learner1.jpg" alt="learner" class="avatar" style="width:32px;height:32px;border-radius:50%;vertical-align:middle;margin-inline-end:8px;">
    Sara Abdullah
  </td>
  <td class="td-question">
    Which HTML tag is used to define a paragraph?
    <!-- نخزّن الخيارات والإجابة الصحيحة كسِمات بيانات -->
    <div class="choices" data-choices='["section","div","p","article"]' data-correct="p"></div>
  </td>
  <td>
    <form class="review-form">
      <input name="comment" class="input" placeholder="Write a note (optional)">
      <div style="margin:8px 0">
        <label style="margin-inline-end:10px">
          <input type="radio" name="decision" value="approve" required> Approve
        </label>
        <label>
          <input type="radio" name="decision" value="reject" required> Disapprove
        </label>
      </div>
      <button type="submit" class="btn">Submit</button>
    </form>
  </td>
</tr>

<tr data-id="rec-1002">
  <td class="td-topic">Networking</td>
  <td class="td-learner">
    <img src="images/learner2.jpg" alt="learner" class="avatar" style="width:32px;height:32px;border-radius:50%;vertical-align:middle;margin-inline-end:8px;">
    Faisal M.
  </td>
  <td class="td-question">
    Which layer handles routing?
    <div class="choices" data-choices='["Physical","Network","Transport","Application"]' data-correct="Network"></div>
  </td>
  <td>
    <form class="review-form">
      <input name="comment" class="input" placeholder="Write a note (optional)">
      <div style="margin:8px 0">
        <label style="margin-inline-end:10px">
          <input type="radio" name="decision" value="approve" required> Approve
        </label>
        <label>
          <input type="radio" name="decision" value="reject" required> Disapprove
        </label>
      </div>
      <button type="submit" class="btn">Submit</button>
    </form>
  </td>
</tr>

        </tbody>
      </table>
    </section>
  </div>

<!-- ====== FOOTER ====== -->
<footer class="cl-footer">
 <p>OUR VISION</p>
 <p>At CodeLand, we make coding education simple, engaging, and accessible for everyone</p>
  <p>© <span id="year"></span>2025 Website. All rights reserved.</p>
  <div class="social">
    <a href="#"><img src="images/xpng.jpg" alt="Twitter"></a>
    <a href="#"><img src="images/facebook.png" alt="Facebook"></a>
    <a href="#"><img src="images/instagram.png" alt="Instagram"></a>
  </div>
</footer>
  <!-- Scripts -->
  <script src="js-deema/utils.nomodule.js"></script>
  <script src="js-deema/storage.nomodule.js"></script>
  <script src="js-deema/data.nomodule.js"></script>
  <script src="js-deema/educator.nomodule.js"></script>
<script>
/* مفاتيح التخزين */
const LS_QUIZZES = 'quizzesByTopic';
const LS_RECOMMENDED = 'recommendedQuestions';

/* أدوات مختصرة للـ LS */
const getLS = (k, fallback) => JSON.parse(localStorage.getItem(k) || fallback);
const setLS = (k, v) => localStorage.setItem(k, JSON.stringify(v));

/* تهيئة هيكل الكويزات إذا ما كان موجود */
function ensureTopic(topic){
  const quizzes = getLS(LS_QUIZZES, '{}');
  if(!quizzes[topic]) quizzes[topic] = { topic, questions: [] };
  setLS(LS_QUIZZES, quizzes);
  return quizzes;
}

/* تحديث عمود #Questions في جدول الكويزات */
function updateQuizCountsUI(){
  const quizzes = getLS(LS_QUIZZES, '{}');
  const rows = document.querySelectorAll('#quizzes-table tbody tr');
  rows.forEach(tr=>{
    const topic = tr.querySelector('td')?.textContent.trim();           // أول عمود = Topic
    const countCell = tr.querySelectorAll('td')[1];                     // ثاني عمود = #Questions
    if(topic && countCell){
      const n = quizzes[topic]?.questions?.length || 0;
      countCell.textContent = n;
    }
  });
}

/* Toast بسيط (اختياري) */
function toast(msg){
  const t = document.getElementById('toast');
  if(!t) return;
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'), 1600);
}

/* حدث إرسال فورم المراجعة */
document.getElementById('recommended-table')?.addEventListener('submit', function(e){
  const form = e.target.closest('.review-form');
  if(!form) return;
  e.preventDefault();

  const row = form.closest('tr');
  const recId = row?.dataset.id;
  const decision = form.querySelector('input[name="decision"]:checked')?.value;

  // اجمع بيانات السؤال من الصف
  const topic = row.querySelector('.td-topic')?.textContent.trim();
  const qText = row.querySelector('.td-question')?.firstChild?.textContent.trim() || '';
  const choicesEl = row.querySelector('.choices');
  let choices = [];
  let correct = '';
  if(choicesEl){
    try { choices = JSON.parse(choicesEl.dataset.choices || '[]'); } catch {}
    correct = choicesEl.dataset.correct || '';
  }

  // 1) احذف الصف فورًا من الواجهة
  row.remove();

  // 2) شيل السؤال من قائمة الـ recommended المخزّنة (لو كنتِ تخزينها)
  const recList = getLS(LS_RECOMMENDED, '[]');
  const idx = recList.findIndex(q => q.id === recId);
  if(idx > -1){
    recList.splice(idx, 1);
    setLS(LS_RECOMMENDED, recList);
  }

  // 3) إذا Approved أضِف السؤال إلى كويز التوبك وحدّث العدّاد
  if(decision === 'approve' && topic){
    const quizzes = ensureTopic(topic);
    quizzes[topic].questions.push({
      id: `q-${Date.now()}`,
      text: qText,
      choices,
      correct,
      figure: null,
      source: 'recommended'
    });
    setLS(LS_QUIZZES, quizzes);
    updateQuizCountsUI();
    toast('Question approved & added to quiz.');
  } else {
    toast('Question dismissed.');
  }
});

/* أول تحميل: حدّث العدادات */
document.addEventListener('DOMContentLoaded', updateQuizCountsUI);
</script>



</body>
</html>
